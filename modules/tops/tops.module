<?php
/**
 * @file
 * This module integrates tops features with Drupal 8
 */
use Tops\Drupal\TViewModel;

/**
 * Implements hook_help().
 */
$drupalAutoloader = require_once(__DIR__.'/../../lib/Tops/start/autoload.php');
require_once(__DIR__.'/../../lib/Tops/start/init.php');
// require_once(__DIR__.'/../../lib/App/start/init.php');


function tops_help($route_name, \Drupal\Core\Routing\RouteMatchInterface $route_match)
{
    return 'Help from tops';
}

/**
 * Implements hook_preprocess().
 */
function tops_preprocess(&$variables, $hook)
{
    if ($hook == 'html') {
      $variables['peanut_messages'] = TViewModel::RenderMessageElements();
      $variables['peanut_start_script'] = TViewModel::RenderStartScript();
    }
}

/**
 * Implements hook_preprocess_HOOK().
 */
/**
 * Implements hook_page_attachments().
 */
function tops_page_attachments(array &$attachments)
{
    if (TViewModel::isVmPage()) {
        $attachments['#attached']['library'][] = 'tops/peanut.app';
    }
}
